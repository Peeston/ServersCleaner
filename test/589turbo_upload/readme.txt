*** Колосов В.В. Ростов-на-Дону 2007г.
Библиотека экспорта локальной таблицы на MS SQL сервер.

В библиотеке представлено три способа выгрузки файлов на MS SQL сервер.
Проверено на SQL2000 и SQL2005.

1. Создается несколько соединений и производится выгрузка в асинхронном
режиме по одной записи на освободившиеся соединения. Не ожидалось особых скоростей,
сделано для эксперимента. Вероятно, пригодно для очень медленных сетей.
2. Выполнение пакета из нескольких команд INSERT в рамках транзакции.
3. На сервере создается процедура для загрузка XML данных, переданных в параметр
этой процедуры.

Все три способа представлены классами UP_MULTI, UP_PACKET, UP_XML.

  Также в библиотеке находится оболочка TURBO_MSSQL_UPLOAD.
Из-за особенностей преобразования данных в XML все названия полей (атрибуты)
в оболочке преобразуются к нижнему регистру. Для изменения выбранного способа
загрузки необходимо в строке 137 метода Command2.Click изменить название объекта
на нужный. Для UP_MULTI первый параметр - строка соединения, а не хэндлер!

  Оболочку можно вызвать двумя способами - с установленным соединением или поручить
ей самой установить соединение с сервером (для использования в виде самостоятельного
приложения).

Пример:

*~* Пример использования класса с "внешним" SQL соединением
SET CLASSLIB TO classlib.vcx

nConn = SQLSTRINGCONNECT("DRIVER=SQL Server;SERVER=(local);Trusted_Connection=Yes;network=dbmssocn")
oForm = CREATEOBJECT('turbo_mssql_upload',nConn)
oForm.Visible=.T.
READ EVENTS
SQLDISCONNECT(nConn)

*~* пример использования класса с собственным SQL соединением
SET CLASSLIB TO classlib.vcx

oForm = CREATEOBJECT('turbo_mssql_upload')
oForm.Visible=.T.
READ EVENTS

Обратите внимание! В методе UNLOAD класса-оболочки выполняется CLEAR EVENTS!